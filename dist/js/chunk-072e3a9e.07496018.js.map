{"version":3,"sources":["webpack:///./src/views/tool.vue?de03","webpack:///./src/lib/qiniu.ts","webpack:///./src/views/ts/tool.ts","webpack:///./src/views/ts/tool.ts?a459","webpack:///./src/views/tool.vue","webpack:///./src/assets/20191111122220.png"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","ref","staticStyle","cropperImage","model","value","callback","$$v","base64","expression","on","$event","cropperShow","uploadBase64","staticRenderFns","getQiNiuToken","key","request","method","url","data","__base64","token","from","post","replace","headers","upLoadBase64","of","Math","random","Date","getTime","pipe","mergeMap","v","QiNiu","tap","map","error","cropperStr","$message","type","message","catchError","subscribe","ToolComponent","component","module","exports"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,UAAU,CAACA,EAAG,MAAM,CAACE,YAAY,WAAWC,MAAM,CAAC,KAAO,UAAUC,KAAK,UAAU,CAACJ,EAAG,OAAO,CAACJ,EAAIS,GAAG,YAAYL,EAAG,UAAU,CAACM,IAAI,UAAUC,YAAY,CAAC,YAAY,SAASJ,MAAM,CAAC,IAAMP,EAAIY,cAAcC,MAAM,CAACC,MAAOd,EAAU,OAAEe,SAAS,SAAUC,GAAMhB,EAAIiB,OAAOD,GAAKE,WAAW,YAAYd,EAAG,MAAMA,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWY,GAAG,CAAC,MAAQ,SAASC,GAAQpB,EAAIqB,aAAc,KAAQ,CAACrB,EAAIS,GAAG,cAAcL,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWY,GAAG,CAAC,MAAQnB,EAAIsB,eAAe,CAACtB,EAAIS,GAAG,QAAQL,EAAG,MAAMA,EAAG,MAAMJ,EAAIS,GAAG,qCAAqC,GAAGL,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,QAAQ,QAAUP,EAAIqB,aAAaF,GAAG,CAAC,iBAAiB,SAASC,GAAQpB,EAAIqB,YAAYD,KAAU,CAAChB,EAAG,MAAM,CAACO,YAAY,CAAC,MAAQ,QAAQJ,MAAM,CAAC,IAAMP,EAAIiB,OAAO,IAAM,SAAS,IAC15BM,EAAkB,G,sLCMtB,2BA+BA,OA7BkB,EAAAC,cAAd,SAA4BC,GACxB,OAAO,OAAAC,EAAA,MAAQ,CAACC,OAAO,OAAQC,IAAK,eAAgBC,KAAK,CAAEJ,IAAG,MAGnD,EAAAK,SAAf,SAAwBb,EAAgBQ,EAAaM,GAEjD,OAAO,OAAAC,EAAA,MAAK,IAAMC,KAAK,0CAA0CR,EAAOR,EAAOiB,QAAQ,0BAA2B,IAAK,CACnHC,QAAS,CACL,eAAgB,2BAChB,cAAiB,WAAaJ,OAM5B,EAAAK,aAAd,SAA2BnB,GACvB,OAAO,OAAAoB,EAAA,MAAGC,KAAKC,UAAS,IAAIC,MAAOC,UAAU,IAAIC,KAC7C,OAAAC,EAAA,OAAS,SAAAC,GAAK,OAAAC,EAAMrB,cAAcoB,GAAGF,KAAK,OAAAI,EAAA,OAAI,SAAArC,GAAM,OAAAA,EAAGoB,KAAKJ,IAAR,SACpD,OAAAsB,EAAA,OAAI,SAAAH,GAAK,OAAAA,EAAA,QACT,OAAAD,EAAA,OAAS,SAAAC,GAAK,OAAAC,EAAMf,SAASb,EAAQ2B,EAAEnB,IAAKmB,EAAEb,OAAOW,KACjD,OAAAI,EAAA,OAAI,SAAAF,GACA,GAAGA,EAAEf,KAAKmB,MACN,MAAMJ,EAAEf,cAOhC,EA/BA,G,gBCCA,yE,OAGY,EAAAoB,WAAqB,GACrB,EAAA5B,aAAuB,EACvB,EAAAT,aAAuB,EAAQ,QAC/B,EAAAK,OAAiB,G,EAS7B,OAf2C,oBAQ/B,YAAAK,aAAR,sBACI,EAAMc,aAAanC,KAAKgB,QAAQyB,KAC5B,OAAAC,EAAA,OAAS,SAAAC,GAAK,SAAKM,SAAS,CAACC,KAAK,UAAUC,QAA9B,cACd,OAAAC,EAAA,OAAW,SAAAT,GAAK,SAAKM,SAAS,CAACC,KAAK,QAAQC,QAA5B,iCAClBE,aAVC,gBAAN,kB,8BAFgBC,EAAa,gBADjC,QACoBA,GAerB,EAfA,CAA2C,KAAtB,ICR0T,I,YCO3UC,EAAY,eACd,EACAzD,EACAwB,GACA,EACA,KACA,KACA,MAIa,aAAAiC,E,8BClBfC,EAAOC,QAAU,IAA0B","file":"js/chunk-072e3a9e.07496018.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page-container\"},[_c('el-card',[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"裁剪工具\")])]),_c('cropper',{ref:\"cropper\",staticStyle:{\"max-width\":\"500px\"},attrs:{\"url\":_vm.cropperImage},model:{value:(_vm.base64),callback:function ($$v) {_vm.base64=$$v},expression:\"base64\"}}),_c('br'),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.cropperShow = true}}},[_vm._v(\"读取base64\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.uploadBase64}},[_vm._v(\"上传\")]),_c('br'),_c('br'),_vm._v(\" 支持v-model绑定获取base64，需传入url图片路径 \")],1),_c('el-dialog',{attrs:{\"title\":\"裁剪的图片\",\"visible\":_vm.cropperShow},on:{\"update:visible\":function($event){_vm.cropperShow=$event}}},[_c('img',{staticStyle:{\"width\":\"100%\"},attrs:{\"src\":_vm.base64,\"alt\":\"\"}})])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Axios from 'axios';\r\nimport { Observable, of, from, throwError } from 'rxjs';\r\nimport request from '@/http/request';\r\nimport { mergeMap, tap, map } from 'rxjs/operators';\r\nimport { CommonResponseData } from '@/http';\r\n\r\n\r\nexport default class QiNiu {\r\n\r\n    public static getQiNiuToken(key: string): Observable<CommonResponseData&{data:{ url: string, token: string }}> {\r\n        return request({method:'POST', url: '/qiniu-token', data:{ key }})\r\n    }\r\n\r\n    private static __base64(base64: string, key: string, token: string): Observable<any> {\r\n        //域名根据不同区域可能需要变化\r\n        return from(Axios.post(`https://upload-z1.qiniup.com/putb64/-1/${key}`, base64.replace('data:image/jpeg;base64,', ''), {\r\n            headers: {\r\n                'Content-Type': 'application/octet-stream',\r\n                'Authorization': 'UpToken ' + token\r\n            }\r\n        }))\r\n    }\r\n\r\n    //通过base64上传到七牛云\r\n    public static upLoadBase64(base64: string): Observable<any> {\r\n        return of(Math.random()+new Date().getTime()+'').pipe(\r\n            mergeMap(v => QiNiu.getQiNiuToken(v).pipe(tap(_v => _v.data.key = v))),\r\n            map(v => v.data),\r\n            mergeMap(v => QiNiu.__base64(base64, v.key, v.token).pipe(\r\n                tap(v => {\r\n                    if(v.data.error){\r\n                        throw v.data;\r\n                    }\r\n                })\r\n            ))\r\n        )\r\n    }\r\n\r\n}","import Component from \"vue-class-component\";\r\nimport { Prop, Ref, Watch } from 'vue-property-decorator'\r\nimport Vue from 'vue'\r\nimport CropperComponent from '@/component/ts/cropper';\r\nimport QiNiu from '@/lib/qiniu';\r\nimport { catchError, mergeMap, tap } from 'rxjs/operators';\r\n\r\n@Component\r\nexport default class ToolComponent extends Vue {\r\n\r\n    @Ref() private cropper!: CropperComponent\r\n    private cropperStr: string = ''\r\n    private cropperShow: boolean = false\r\n    private cropperImage: string = require('@/assets/20191111122220.png')\r\n    private base64: string = '';\r\n\r\n    private uploadBase64(): void {\r\n        QiNiu.upLoadBase64(this.base64).pipe(\r\n            mergeMap(v => this.$message({type:'success',message:'假的上传成功'})),\r\n            catchError(v => this.$message({type:'error',message:'实际上七牛云的token是假的，所有肯定无法上传'}))\r\n        ).subscribe()\r\n    }\r\n\r\n}\r\n\r\n// type AlbumAPIResponse = {\r\n//     title: string\r\n//     artist?: {\r\n//       name: string\r\n//       bio?: string\r\n//       previousAlbums?: string[]\r\n//     }\r\n//   };\r\n  \r\n//   declare const album: AlbumAPIResponse;\r\n  \r\n  // With optional chaining, you can write\r\n  // code like this:\r\n  ","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/ts-loader/index.js??ref--13-3!./tool.ts?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/ts-loader/index.js??ref--13-3!./tool.ts?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./tool.vue?vue&type=template&id=460924ce&\"\nimport script from \"./ts/tool?vue&type=script&lang=js&\"\nexport * from \"./ts/tool?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/20191111122220.43dc9686.png\";"],"sourceRoot":""}