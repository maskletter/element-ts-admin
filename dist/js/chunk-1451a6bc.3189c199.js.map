{"version":3,"sources":["webpack:///./src/assets/20191111122220.png","webpack:///./src/views/crop.vue?fb2a","webpack:///./src/lib/qiniu.ts","webpack:///./src/views/ts/tool.ts","webpack:///./src/views/ts/tool.ts?a459","webpack:///./src/views/crop.vue"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","ref","staticStyle","cropperImage","model","value","callback","$$v","base64","expression","on","$event","cropperShow","uploadBase64","staticRenderFns","getQiNiuToken","key","request","method","url","data","__base64","token","from","post","replace","headers","_file","file","upLoadBase64","of","Math","random","Date","getTime","pipe","mergeMap","v","QiNiu","tap","map","error","upLoadFile","cropperStr","$message","type","message","catchError","subscribe","ToolComponent","component"],"mappings":"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","file":"js/chunk-1451a6bc.3189c199.js","sourcesContent":["module.exports = __webpack_public_path__ + \"img/20191111122220.43dc9686.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page-container\"},[_c('el-card',[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"裁剪工具\")])]),_c('cropper',{ref:\"cropper\",staticStyle:{\"max-width\":\"500px\"},attrs:{\"url\":_vm.cropperImage},model:{value:(_vm.base64),callback:function ($$v) {_vm.base64=$$v},expression:\"base64\"}}),_c('br'),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.cropperShow = true}}},[_vm._v(\"读取base64\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.uploadBase64}},[_vm._v(\"上传\")]),_c('br'),_c('br'),_vm._v(\" 支持v-model绑定获取base64，需传入url图片路径 \")],1),_c('el-dialog',{attrs:{\"title\":\"裁剪的图片\",\"visible\":_vm.cropperShow},on:{\"update:visible\":function($event){_vm.cropperShow=$event}}},[_c('img',{staticStyle:{\"width\":\"100%\"},attrs:{\"src\":_vm.base64,\"alt\":\"\"}})])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Axios from 'axios';\nimport { Observable, of, from, throwError } from 'rxjs';\nimport request from '@/http/request';\nimport { mergeMap, tap, map } from 'rxjs/operators';\nimport { CommonResponseData } from '@/http';\n\n\nexport default class QiNiu {\n\n    public static getQiNiuToken(key: string): Observable<CommonResponseData&{data:{ url: string, token: string }}> {\n        return request({method:'POST', url: '/qiniu-token', data:{ key }})\n    }\n\n    private static __base64(base64: string, key: string, token: string): Observable<any> {\n        //域名根据不同区域可能需要变化\n        return from(Axios.post(`https://upload-z1.qiniup.com/putb64/-1/${key}`, base64.replace('data:image/jpeg;base64,', ''), {\n            headers: {\n                'Content-Type': 'application/octet-stream',\n                'Authorization': 'UpToken ' + token\n            }\n        }))\n    }\n\n    private static _file(key: string, token: string, file:File): Observable<any> {\n        return from(Axios.post('https://up-z1.qiniup.com', {\n            token, key, file\n        }))\n    }\n\n    //通过base64上传到七牛云\n    public static upLoadBase64(base64: string): Observable<any> {\n        return of(Math.random()+new Date().getTime()+'').pipe(\n            mergeMap(v => QiNiu.getQiNiuToken(v).pipe(tap(_v => _v.data.key = v))),\n            map(v => v.data),\n            mergeMap(v => QiNiu.__base64(base64, v.key, v.token).pipe(\n                tap(v => {\n                    if(v.data.error){\n                        throw v.data;\n                    }\n                })\n            ))\n        )\n    }\n    \n    //通过file上传到七牛云\n    public static upLoadFile(_file: File): Observable<any> {\n        return of(Math.random()+new Date().getTime()+'').pipe(\n            mergeMap(v => QiNiu.getQiNiuToken(v).pipe(tap(_v => _v.data.key = v))),\n            map(v => v.data),\n            mergeMap(v => QiNiu._file(v.key, v.token, _file).pipe(\n                tap(v => {\n                    if(v.data.error){\n                        throw v.data;\n                    }\n                })\n            ))\n        )\n    }\n\n}","import Component from \"vue-class-component\";\nimport { Prop, Ref, Watch } from 'vue-property-decorator'\nimport Vue from 'vue'\nimport CropperComponent from '@/component/ts/cropper';\nimport QiNiu from '@/lib/qiniu';\nimport { catchError, mergeMap, tap } from 'rxjs/operators';\n\n@Component\nexport default class ToolComponent extends Vue {\n\n    @Ref() private cropper!: CropperComponent\n    private cropperStr: string = ''\n    private cropperShow: boolean = false\n    private cropperImage: string = require('@/assets/20191111122220.png')\n    private base64: string = '';\n\n    private uploadBase64(): void {\n        QiNiu.upLoadBase64(this.base64).pipe(\n            mergeMap(v => this.$message({type:'success',message:'假的上传成功'})),\n            catchError(v => this.$message({type:'error',message:'实际上七牛云的token是假的，所有肯定无法上传'}))\n        ).subscribe()\n    }\n\n}\n\n// type AlbumAPIResponse = {\n//     title: string\n//     artist?: {\n//       name: string\n//       bio?: string\n//       previousAlbums?: string[]\n//     }\n//   };\n  \n//   declare const album: AlbumAPIResponse;\n  \n  // With optional chaining, you can write\n  // code like this:\n  ","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/ts-loader/index.js??ref--13-3!./tool.ts?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/ts-loader/index.js??ref--13-3!./tool.ts?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./crop.vue?vue&type=template&id=7f01acea&\"\nimport script from \"./ts/tool?vue&type=script&lang=js&\"\nexport * from \"./ts/tool?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}